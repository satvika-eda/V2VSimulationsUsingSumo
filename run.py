from simulation import *
from DQNModelTorch import *
import torch.optim as optim

start_simulation()
epsilon = 1.0  # Initial epsilon value
epsilon_min = 0.01  # Minimum epsilon value
epsilon_decay = 0.995
for i in range(500):
    print("episode : ", i)
    # print("simulation started")
    # print("simulation ran as well") 
    epsilon = max(epsilon * epsilon_decay, epsilon_min)
    run_simulation(model, epsilon) 
    train_dqn(model, 50)
    model.memory = []
graph()
traci.close() 


# [21805.88671875, 9004.52734375, 0.015640949830412865, 5403.82080078125, 7206.37646484375, 5404.01904296875, 3602.360107421875, 9005.3876953125, 3603.062255859375, 5404.66748046875, 9006.0830078125, 5401.44287109375, 0.01578274555504322, 9006.095703125, 7206.06103515625, 3600.7265625, 5403.08203125, 3603.056884765625, 5401.47998046875, 1800.034912109375, 7202.173828125, 7206.0400390625, 0.014388634823262691, 9006.0546875, 0.015244413167238235, 5403.03662109375, 9006.0126953125, 3602.322509765625, 7206.15673828125, 5403.03369140625, 9008.3388671875, 3601.412109375, 9004.42578125, 5403.0283203125, 7204.37890625, 0.014556793496012688, 0.015338501892983913, 5403.060546875, 7203.88818359375, 3600.810546875, 7205.25048828125, 5403.0, 3602.869384765625, 0.010042746551334858, 7203.689453125, 0.01479302067309618, 7203.72607421875, 1802.211181640625, 7205.79736328125, 9004.3818359375, 5402.98583984375, 5403.61767578125, 3602.28759765625, 3602.853271484375, 7203.68603515625, 9004.373046875, 9004.333984375, 5403.56591796875, 7204.20703125, 3600.881103515625, 9005.859375, 7205.4248046875, 7203.20654296875, 7207.3935546875, 9004.341796875, 3602.851318359375, 9006.0908203125, 7202.23193359375, 0.019350871443748474, 7203.7158203125, 3600.90234375, 7204.1640625, 7204.10791015625, 7207.18701171875, 9005.7158203125, 3604.876708984375, 7202.25, 9004.3564453125, 3600.510498046875, 7205.07568359375, 9005.7177734375, 0.012749888002872467, 5403.431640625, 0.014725088141858578, 3604.078369140625, 7203.60888671875, 7205.39306640625, 0.015608731657266617, 7203.61279296875, 3604.061279296875, 7204.0224609375, 9005.93359375, 7205.32470703125, 0.015340304933488369, 7203.95068359375, 7204.95947265625, 9004.3046875, 5403.58447265625, 7205.23876953125, 5403.2109375]
